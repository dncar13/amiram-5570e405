<!DOCTYPE html>
<html lang="he" dir="rtl">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>×‘×“×™×§×ª ××¢×¨×›×ª ×”×¡×™× ×•×Ÿ - ×”×‘× ×ª ×”× ×§×¨×</title>
    <style>
      body {
        font-family: "Segoe UI", Tahoma, Geneva, Verdana, sans-serif;
        direction: rtl;
        text-align: right;
        margin: 20px;
        background-color: #f5f5f5;
      }
      .container {
        max-width: 800px;
        margin: 0 auto;
        background: white;
        padding: 20px;
        border-radius: 10px;
        box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
      }
      .test-section {
        margin: 20px 0;
        padding: 15px;
        border: 1px solid #ddd;
        border-radius: 8px;
        background: #f9f9f9;
      }
      .success {
        color: green;
        font-weight: bold;
      }
      .error {
        color: red;
        font-weight: bold;
      }
      .story-item {
        margin: 10px 0;
        padding: 10px;
        border: 1px solid #ccc;
        border-radius: 5px;
        background: white;
      }
      .filter-controls {
        margin: 15px 0;
        padding: 10px;
        background: #e8f4fd;
        border-radius: 5px;
      }
      select,
      button {
        margin: 5px;
        padding: 8px;
        border: 1px solid #ccc;
        border-radius: 4px;
        font-size: 14px;
      }
      button {
        background: #007bff;
        color: white;
        cursor: pointer;
      }
      button:hover {
        background: #0056b3;
      }
    </style>
  </head>
  <body>
    <div class="container">
      <h1>ğŸ” ×‘×“×™×§×ª ××¢×¨×›×ª ×”×¡×™× ×•×Ÿ - ×”×‘× ×ª ×”× ×§×¨×</h1>

      <div class="test-section">
        <h2>ğŸ“Š × ×ª×•× ×™ ××¢×¨×›×ª</h2>
        <div id="system-info">×˜×•×¢×Ÿ...</div>
      </div>

      <div class="test-section">
        <h2>ğŸ¯ ×‘×“×™×§×ª ×¡×™×•×•×’ × ×•×©××™×</h2>
        <div id="classification-test">×˜×•×¢×Ÿ...</div>
      </div>

      <div class="test-section">
        <h2>ğŸ“š ×¡×™×¤×•×¨×™× ×–××™× ×™×</h2>
        <div class="filter-controls">
          <label>×¨××ª ×§×•×©×™: </label>
          <select id="difficulty-filter">
            <option value="all">×”×›×œ</option>
            <option value="easy">×§×œ</option>
            <option value="medium">×‘×™× ×•× ×™</option>
            <option value="hard">×§×©×”</option>
          </select>

          <label>× ×•×©×: </label>
          <select id="subject-filter">
            <option value="all">×”×›×œ</option>
            <option value="technology">×˜×›× ×•×œ×•×’×™×”</option>
            <option value="economics">×›×œ×›×œ×”</option>
            <option value="health">×‘×¨×™××•×ª</option>
            <option value="society">×—×‘×¨×”</option>
            <option value="environment">×¡×‘×™×‘×”</option>
          </select>

          <button onclick="filterStories()">×¡× ×Ÿ</button>
          <button onclick="resetFilters()">××™×¤×•×¡</button>
        </div>
        <div id="stories-list">×˜×•×¢×Ÿ...</div>
      </div>

      <div class="test-section">
        <h2>ğŸ“ˆ ×¡×˜×˜×™×¡×˜×™×§×•×ª</h2>
        <div id="statistics">×˜×•×¢×Ÿ...</div>
      </div>
    </div>

    <script type="module">
      // ××¡××•×œ×¦×™×™×ª ×”××¢×¨×›×ª - ×‘×¡×‘×™×‘×” ×××™×ª×™×ª ×–×” ×™×•×‘× ××”×§×‘×¦×™×
      const mockQuestions = [
        {
          id: 1,
          type: "reading-comprehension",
          passageTitle: "×›×œ×›×œ×ª ×”×’×™×’: ××”×¤×›×” ×‘×¢×•×œ× ×”×¢×‘×•×“×”",
          passageText:
            "×”×©×•×§ ×”×—×•×¤×©×™ ××‘×•×¡×¡ ×¢×œ ×¢×§×¨×•× ×•×ª ×©×œ ×”×™×¦×¢ ×•×‘×™×§×•×©. ×›×œ×›×œ×ª ×”×’×™×’ ××©× ×” ××ª ×“×¤×•×¡×™ ×”×¢×‘×•×“×” ×”××¡×•×¨×ª×™×™×...",
          difficulty: "medium",
          text: "××” ×”××•×©×’ ×”××¨×›×–×™ ×‘×˜×§×¡×˜?",
        },
        {
          id: 2,
          type: "reading-comprehension",
          passageTitle: "The Changing Nature of Work",
          passageText:
            "Technology is revolutionizing the workplace. Artificial intelligence and automation are changing how we work...",
          difficulty: "hard",
          text: "What is the main topic of the passage?",
        },
        {
          id: 3,
          type: "reading-comprehension",
          passageTitle: "Climate Change Impact",
          passageText:
            "Global warming affects ecosystems worldwide. Rising temperatures cause ice caps to melt and sea levels to rise...",
          difficulty: "easy",
          text: "What environmental effects are mentioned?",
        },
        {
          id: 4,
          type: "reading-comprehension",
          passageTitle: "Online Education Revolution",
          passageText:
            "Digital learning platforms have made education accessible to millions. Online courses offer flexibility and convenience...",
          difficulty: "medium",
          text: "What are the benefits of online education?",
        },
      ]; // ×¤×•× ×§×¦×™×•×ª ×¡×™×•×•×’ × ×•×©××™× (9 × ×•×©××™×)
      const subjectKeywords = {
        technology: [
          "×˜×›× ×•×œ×•×’×™×”",
          "×‘×™× ×” ××œ××›×•×ª×™×ª",
          "×¨×•×‘×•×˜×™×§×”",
          "technology",
          "artificial intelligence",
          "automation",
          "digital",
        ],
        economics: [
          "×›×œ×›×œ×”",
          "×©×•×§",
          "×”×™×¦×¢",
          "×‘×™×§×•×©",
          "×’×™×’",
          "economy",
          "market",
          "financial",
          "business",
        ],
        engineering: [
          "×”× ×“×¡×”",
          "×˜×›× ×™",
          "××¢×¨×›×ª",
          "engineering",
          "technical",
          "system",
          "design",
        ],
        health: [
          "×‘×¨×™××•×ª",
          "×¨×¤×•××”",
          "×—×•×œ×™×",
          "health",
          "medical",
          "healthcare",
          "medicine",
        ],
        society: [
          "×—×‘×¨×”",
          "×§×”×™×œ×”",
          "×× ×©×™×",
          "society",
          "community",
          "social",
          "people",
        ],
        education: [
          "×—×™× ×•×š",
          "×‘×™×ª ×¡×¤×¨",
          "×ª×œ××™×“",
          "education",
          "school",
          "student",
          "learning",
        ],
        environment: [
          "×¡×‘×™×‘×”",
          "××§×œ×™×",
          "×–×™×”×•×",
          "environment",
          "climate",
          "warming",
          "ecosystems",
          "temperature",
        ],
        education: [
          "×—×™× ×•×š",
          "×œ×™××•×“×™×",
          "×§×•×¨×¡×™×",
          "education",
          "learning",
          "courses",
          "online",
          "digital learning",
        ],
      };

      function classifySubject(text, title = "") {
        const content = (text + " " + title).toLowerCase();

        for (const [subject, keywords] of Object.entries(subjectKeywords)) {
          if (
            keywords.some((keyword) => content.includes(keyword.toLowerCase()))
          ) {
            return subject;
          }
        }
        return null;
      }

      function getAvailableStories() {
        const groupedByTitle = {};

        mockQuestions.forEach((q) => {
          if (q.type === "reading-comprehension" && q.passageTitle) {
            if (!groupedByTitle[q.passageTitle]) {
              const subject = classifySubject(
                q.passageText || "",
                q.passageTitle
              );

              groupedByTitle[q.passageTitle] = {
                id: q.passageTitle.replace(/\\s+/g, "-").toLowerCase(),
                title: q.passageTitle,
                description: q.passageText?.substring(0, 100) + "..." || "",
                questionCount: 1,
                difficulty: q.difficulty,
                subject: subject,
                questions: [q],
              };
            } else {
              groupedByTitle[q.passageTitle].questionCount++;
              groupedByTitle[q.passageTitle].questions.push(q);
            }
          }
        });

        return Object.values(groupedByTitle);
      }

      function getFilteredStories(
        difficultyFilter = "all",
        subjectFilter = "all"
      ) {
        let stories = getAvailableStories();

        if (difficultyFilter !== "all") {
          stories = stories.filter(
            (story) => story.difficulty === difficultyFilter
          );
        }

        if (subjectFilter !== "all") {
          stories = stories.filter((story) => story.subject === subjectFilter);
        }

        return stories;
      }

      function displaySystemInfo() {
        const allStories = getAvailableStories();
        const allSubjects = [
          ...new Set(allStories.map((s) => s.subject).filter(Boolean)),
        ];

        document.getElementById("system-info").innerHTML = `
                <div class="success">âœ… ××¢×¨×›×ª ×”×¡×™× ×•×Ÿ ×¤×•×¢×œ×ª</div>
                <p><strong>×¡×”"×› ×¡×™×¤×•×¨×™× ×–××™× ×™×:</strong> ${
                  allStories.length
                }</p>
                <p><strong>× ×•×©××™× ×–××™× ×™×:</strong> ${allSubjects.join(", ")}</p>
                <p><strong>×¨××•×ª ×§×•×©×™ ×–××™× ×•×ª:</strong> ${[
                  ...new Set(allStories.map((s) => s.difficulty)),
                ].join(", ")}</p>
            `;
      }

      function displayClassificationTest() {
        const testCases = [
          { text: "×›×œ×›×œ×ª ×”×©×•×§ ×”×—×•×¤×©×™", expected: "economics" },
          { text: "×˜×›× ×•×œ×•×’×™×” ×•×‘×™× ×” ××œ××›×•×ª×™×ª", expected: "technology" },
          { text: "×”×©×¤×¢×•×ª ×©×™× ×•×™×™ ×”××§×œ×™× ×¢×œ ×”×¡×‘×™×‘×”", expected: "environment" },
          { text: "××¢×¨×›×ª ×”×—×™× ×•×š ×”×“×™×’×™×˜×œ×™×ª", expected: "education" },
        ];

        let html = "";
        testCases.forEach((test) => {
          const result = classifySubject(test.text);
          const isCorrect = result === test.expected;
          html += `
                    <div style="margin: 10px 0;">
                        <strong>×˜×§×¡×˜:</strong> "${test.text}"<br>
                        <strong>×¦×¤×•×™:</strong> ${
                          test.expected
                        }, <strong>×§×™×‘×œ× ×•:</strong> ${result}
                        <span class="${isCorrect ? "success" : "error"}">
                            ${isCorrect ? "âœ… ×”×¦×œ×—×”" : "âŒ ×›×©×œ"}
                        </span>
                    </div>
                `;
        });

        document.getElementById("classification-test").innerHTML = html;
      }

      function displayStories(stories = null) {
        if (!stories) {
          stories = getAvailableStories();
        }

        if (stories.length === 0) {
          document.getElementById("stories-list").innerHTML =
            '<div class="error">âŒ ×œ× × ××¦××• ×¡×™×¤×•×¨×™× ×”×ª×•×××™× ×œ×¡×™× ×•×Ÿ</div>';
          return;
        }

        let html = `<div class="success">âœ… × ××¦××• ${stories.length} ×¡×™×¤×•×¨×™×</div>`;

        stories.forEach((story) => {
          const difficultyMap = {
            easy: "×§×œ",
            medium: "×‘×™× ×•× ×™",
            hard: "×§×©×”",
          };

          const subjectMap = {
            technology: "×˜×›× ×•×œ×•×’×™×”",
            economics: "×›×œ×›×œ×”",
            environment: "×¡×‘×™×‘×”",
            education: "×—×™× ×•×š",
            society: "×—×‘×¨×”",
            health: "×‘×¨×™××•×ª",
          };

          html += `
                    <div class="story-item">
                        <h4>${story.title}</h4>
                        <p>${story.description}</p>
                        <p><strong>×©××œ×•×ª:</strong> ${story.questionCount} | 
                           <strong>×§×•×©×™:</strong> ${
                             difficultyMap[story.difficulty] || story.difficulty
                           } | 
                           <strong>× ×•×©×:</strong> ${
                             subjectMap[story.subject] ||
                             story.subject ||
                             "×›×œ×œ×™"
                           }</p>
                    </div>
                `;
        });

        document.getElementById("stories-list").innerHTML = html;
      }

      function displayStatistics() {
        const stories = getAvailableStories();
        const difficultyStats = {};
        const subjectStats = {};

        stories.forEach((story) => {
          difficultyStats[story.difficulty] =
            (difficultyStats[story.difficulty] || 0) + 1;
          if (story.subject) {
            subjectStats[story.subject] =
              (subjectStats[story.subject] || 0) + 1;
          }
        });

        const difficultyMap = { easy: "×§×œ", medium: "×‘×™× ×•× ×™", hard: "×§×©×”" };
        const subjectMap = {
          technology: "×˜×›× ×•×œ×•×’×™×”",
          economics: "×›×œ×›×œ×”",
          environment: "×¡×‘×™×‘×”",
          education: "×—×™× ×•×š",
        };

        let html = "<h4>×—×œ×•×§×” ×œ×¤×™ ×¨××ª ×§×•×©×™:</h4>";
        Object.entries(difficultyStats).forEach(([diff, count]) => {
          html += `<p>${difficultyMap[diff] || diff}: ${count} ×¡×™×¤×•×¨×™×</p>`;
        });

        html += "<h4>×—×œ×•×§×” ×œ×¤×™ × ×•×©×:</h4>";
        Object.entries(subjectStats).forEach(([subject, count]) => {
          html += `<p>${subjectMap[subject] || subject}: ${count} ×¡×™×¤×•×¨×™×</p>`;
        });

        document.getElementById("statistics").innerHTML = html;
      }

      // ×”×•×¡×¤×ª ×¤×•× ×§×¦×™×•×ª ×œ×—×œ×•×Ÿ ×”×’×œ×•×‘×œ×™
      window.filterStories = function () {
        const difficultyFilter =
          document.getElementById("difficulty-filter").value;
        const subjectFilter = document.getElementById("subject-filter").value;
        const filteredStories = getFilteredStories(
          difficultyFilter,
          subjectFilter
        );
        displayStories(filteredStories);
      };

      window.resetFilters = function () {
        document.getElementById("difficulty-filter").value = "all";
        document.getElementById("subject-filter").value = "all";
        displayStories();
      };

      // ×˜×¢×™× ×” ×¨××©×•× ×™×ª
      displaySystemInfo();
      displayClassificationTest();
      displayStories();
      displayStatistics();

      console.log("ğŸ¯ ×‘×“×™×§×ª ××¢×¨×›×ª ×”×¡×™× ×•×Ÿ ×”×•×©×œ××” ×‘×”×¦×œ×—×”!");
    </script>
  </body>
</html>
